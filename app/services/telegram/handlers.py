"""–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ –∏ —Å–æ–æ–±—â–µ–Ω–∏–π Telegram."""

from __future__ import annotations

from loguru import logger

from app.services.rag.answer import answer_generator


class TelegramHandlers:
    """–ö–æ–º–∞–Ω–¥–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ Telegram –±–æ—Ç–∞."""

    @staticmethod
    async def handle_start(chat_id: int, user_name: str) -> str:
        """–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–æ–º–∞–Ω–¥—É /start."""
        logger.info(
            "Telegram: –∫–æ–º–∞–Ω–¥–∞ /start –æ—Ç %s (chat_id=%s)",
            user_name,
            chat_id,
        )
        return (
            f"üëã <b>–ü—Ä–∏–≤–µ—Ç, {user_name}!</b>\n\n"
            "–Ø ‚Äî –ò–ò-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –ø–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –±–∏–∑–Ω–µ—Å–∞.\n\n"
            "<b>–ß—Ç–æ —è —É–º–µ—é:</b>\n"
            "‚Ä¢ –ö–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ –Ω–∞—à–∏–º —É—Å–ª—É–≥–∞–º\n"
            "‚Ä¢ –†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–æ–µ–∫—Ç–∞\n"
            "‚Ä¢ –ü–æ–¥–æ–±—Ä–∞—Ç—å —Ä–µ—à–µ–Ω–∏–µ –ø–æ–¥ –≤–∞—à–∏ –∑–∞–¥–∞—á–∏\n"
            "‚Ä¢ –û—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –æ–± –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏\n\n"
            "<b>–ö–æ–º–∞–Ω–¥—ã:</b>\n"
            "/help ‚Äî —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥\n"
            "/services ‚Äî –Ω–∞—à–∏ —É—Å–ª—É–≥–∏\n"
            "/price ‚Äî —É–∑–Ω–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å\n\n"
            "–ó–∞–¥–∞–≤–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å—ã ‚Äî —è –æ—Ç–≤–µ—á—É!"
        )

    @staticmethod
    async def handle_help(chat_id: int) -> str:
        """–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–æ–º–∞–Ω–¥—É /help."""
        logger.info("Telegram: –∫–æ–º–∞–Ω–¥–∞ /help –æ—Ç chat_id=%s", chat_id)
        return (
            "üìã <b>–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:</b>\n\n"
            "/start ‚Äî –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è\n"
            "/help ‚Äî —ç—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞\n"
            "/services ‚Äî —Å–ø–∏—Å–æ–∫ –Ω–∞—à–∏—Ö —É—Å–ª—É–≥\n"
            "/price ‚Äî —É–∑–Ω–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å\n"
            "/contact ‚Äî —Å–≤—è–∑–∞—Ç—å—Å—è —Å –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º\n\n"
            "–ò–ª–∏ –ø—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏—Ç–µ –≤–∞—à –≤–æ–ø—Ä–æ—Å!"
        )

    @staticmethod
    async def handle_services(chat_id: int) -> str:
        """–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–æ–º–∞–Ω–¥—É /services."""
        logger.info("Telegram: –∫–æ–º–∞–Ω–¥–∞ /services –æ—Ç chat_id=%s", chat_id)
        return (
            "üöÄ <b>–ù–∞—à–∏ —É—Å–ª—É–≥–∏:</b>\n\n"
            "<b>1. –ò–ò-–ú–µ–Ω–µ–¥–∂–µ—Ä</b>\n"
            "–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –æ–±—â–µ–Ω–∏—è —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏ —á–µ—Ä–µ–∑ –ò–ò\n"
            "‚Ä¢ Avito, Telegram, WhatsApp\n"
            "‚Ä¢ –ö–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏—è –ª–∏–¥–æ–≤\n"
            "‚Ä¢ –û—Ç 50,000 ‚ÇΩ\n\n"
            "<b>2. –ò–ò-–ê–Ω–∞–ª–∏—Ç–∏–∫</b>\n"
            "–ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ\n"
            "‚Ä¢ –û—Ç—á—ë—Ç—ã –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º\n"
            "‚Ä¢ –ü—Ä–æ–≥–Ω–æ–∑ —Å–ø—Ä–æ—Å–∞\n"
            "‚Ä¢ –û—Ç 80,000 ‚ÇΩ\n\n"
            "<b>3. –ò–ò-–î–æ–∫—É–º–µ–Ω—Ç–æ–≤–µ–¥</b>\n"
            "–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤\n"
            "‚Ä¢ –î–æ–≥–æ–≤–æ—Ä—ã, –ö–ü\n"
            "‚Ä¢ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–æ–±–æ—Ä–æ—Ç–∞\n"
            "‚Ä¢ –û—Ç 60,000 ‚ÇΩ\n\n"
            "–ù–∞–ø–∏—à–∏—Ç–µ –∫–∞–∫–∞—è —É—Å–ª—É–≥–∞ –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç ‚Äî —Ä–∞—Å—Å–∫–∞–∂—É –ø–æ–¥—Ä–æ–±–Ω–µ–µ!"
        )

    @staticmethod
    async def handle_price(chat_id: int) -> str:
        """–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–æ–º–∞–Ω–¥—É /price."""
        logger.info("Telegram: –∫–æ–º–∞–Ω–¥–∞ /price –æ—Ç chat_id=%s", chat_id)
        return (
            "üí∞ <b>–°—Ç–æ–∏–º–æ—Å—Ç—å —É—Å–ª—É–≥:</b>\n\n"
            "üì¶ <b>–°—Ç–∞—Ä—Ç</b> ‚Äî –æ—Ç 50,000 ‚ÇΩ\n"
            "‚Ä¢ –ë–∞–∑–æ–≤–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è\n"
            "‚Ä¢ 1 –∫–∞–Ω–∞–ª (Avito/Telegram)\n"
            "‚Ä¢ –¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞ 1 –º–µ—Å—è—Ü\n\n"
            "üöÄ <b>–û–ø—Ç–∏–º—É–º</b> ‚Äî –æ—Ç 150,000 ‚ÇΩ\n"
            "‚Ä¢ –ü–æ–ª–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è\n"
            "‚Ä¢ 3 –∫–∞–Ω–∞–ª–∞\n"
            "‚Ä¢ RAG —Å–∏—Å—Ç–µ–º–∞\n"
            "‚Ä¢ –¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞ 3 –º–µ—Å—è—Ü–∞\n\n"
            "‚≠ê <b>Enterprise</b> ‚Äî –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ\n"
            "‚Ä¢ –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è\n"
            "‚Ä¢ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –ª—é–±—ã–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏\n"
            "‚Ä¢ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞\n\n"
            "–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ –≤–∞—à–∏—Ö –∑–∞–¥–∞—á–∞—Ö ‚Äî –ø–æ–¥–±–µ—Ä—É –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ!"
        )

    @staticmethod
    async def handle_text_message(
        chat_id: int,
        text: str,
        user_name: str,
    ) -> str:
        """–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –ø–æ–º–æ—â—å—é RAG."""
        logger.info(
            "Telegram: —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç %s (chat_id=%s): %s",
            user_name,
            chat_id,
            text[:50],
        )
        return await answer_generator.generate_answer(text, user_name)
